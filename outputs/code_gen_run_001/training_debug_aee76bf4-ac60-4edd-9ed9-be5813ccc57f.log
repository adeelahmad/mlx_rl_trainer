2025-10-07 08:47:31 - DEBUG - [mlx_rl_trainer.rewards.base_reward:41] - Initialized CodeExecutionReward with config: {'timeout': 3, 'think_open_tag': '<think>', 'think_close_tag': '</think>', 'answer_open_tag': '<answer>', 'answer_close_tag': '</answer>'}
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.rewards.programming.code_execution:123] - Initialized CodeExecutionReward with timeout: 3s.
2025-10-07 08:47:31 - DEBUG - [mlx_rl_trainer.rewards.registry:85] - Created reward instance: 'code_execution'.
2025-10-07 08:47:31 - DEBUG - [mlx_rl_trainer.rewards.base_reward:41] - Initialized SemanticSimilarityReward with config: {'method': 'tfidf', 'think_open_tag': '<think>', 'think_close_tag': '</think>', 'answer_open_tag': '<answer>', 'answer_close_tag': '</answer>'}
2025-10-07 08:47:31 - DEBUG - [mlx_rl_trainer.rewards.registry:85] - Created reward instance: 'content_similarity'.
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.rewards.base_reward:137] - Initialized RewardComposer with 2 rewards.
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.scripts.train:182] - Created reward composer with 2 rewards.
2025-10-07 08:47:31 - INFO - [root:39] - DatasetManager initialized with config: train_path=PosixPath('mlx_rl_trainer/data/dummy_train.jsonl') val_path=PosixPath('mlx_rl_trainer/data/dummy_val.jsonl') max_prompt_len=512 max_gen_len=384 loader_type='jsonl' shuffle_data=True dataset_prompt_key='prompt' dataset_answer_key='completion' dataset_filter_keywords=['http', 'qwen']
2025-10-07 08:47:31 - INFO - [root:80] - CheckpointManager initialized for outputs/code_gen_run_001/checkpoints. Keeping last 3 checkpoints.
2025-10-07 08:47:31 - INFO - [root:100] - BaseTrainer initialized with injected dependencies.
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.algorithms.grpo.grpo_trainer:82] - GRPOTrainer initialized for run ID: 6a67e188-3c90-4539-aee4-f120402458c9.
2025-10-07 08:47:31 - INFO - [root:331] - Attempting to load 'actor' model from /Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/latest...
2025-10-07 08:47:31 - INFO - [root:331] - Attempting to load 'reference' model from /Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/latest...
2025-10-07 08:47:31 - DEBUG - [mlx_rl_trainer.algorithms.base_algorithm:41] - BaseAlgorithm initialized for GRPOAlgorithm.
2025-10-07 08:47:31 - INFO - [root:170] - Training will start from update step 0, epoch 0.
2025-10-07 08:47:31 - CRITICAL - [root:308] - An unexpected error halted training: Data file not found: mlx_rl_trainer/data/dummy_train.jsonl
Traceback (most recent call last):
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py", line 184, in run
    await self.data_manager.load_datasets()
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py", line 113, in load_datasets
    results = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py", line 88, in load_task
    return await self._async_read_jsonl(path)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py", line 44, in _async_read_jsonl
    raise FileNotFoundError(f"Data file not found: {path}")
FileNotFoundError: Data file not found: mlx_rl_trainer/data/dummy_train.jsonl
2025-10-07 08:47:31 - INFO - [root:310] - Training process finalized. Saving final state.
2025-10-07 08:47:31 - CRITICAL - [mlx_rl_trainer.scripts.train:251] - An unexpected system error occurred: argument of type 'NoneType' is not iterable
Traceback (most recent call last):
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py", line 245, in _main_async
    await trainer.run()
  File "/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py", line 314, in run
    if hasattr(pbar, "postfix") and "Reward" in pbar.postfix
                                    ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: argument of type 'NoneType' is not iterable
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.scripts.train:254] - Application shutdown initiated.
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.monitoring.metrics_logger:82] - Metrics CSV logger opened: outputs/code_gen_run_001/training_metrics_aee76bf4-ac60-4edd-9ed9-be5813ccc57f.csv
2025-10-07 08:47:31 - INFO - [mlx_rl_trainer.monitoring.metrics_logger:200] - No substantial training_metrics.csv found; skipping plots.

[2;36m[10/07/25 21:57:41][0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.scripts.train:W&B logging initialized: [4;94mhttps://wandb.ai/adeelahmad99/mlx-grpo/runs/20251007_215738_d6d4abcd[0m                                            ]8;id=481741;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py\[2mtrain.py[0m]8;;\[2m:[0m]8;id=562275;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py#135\[2m135[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.base_reward:Initialized CodeExecutionReward with config: [1m{[0m[32m'timeout'[0m: [1;36m3[0m[1m}[0m                                                                  ]8;id=869693;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=659176;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#37\[2m37[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.rewards.programming.code_execution:Initialized CodeExecutionReward with timeout: 3s.                                                          ]8;id=738797;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/programming/code_execution.py\[2mcode_execution.py[0m]8;;\[2m:[0m]8;id=72933;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/programming/code_execution.py#125\[2m125[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.registry:Created reward instance: [32m'code_execution'[0m.                                                                                         ]8;id=896865;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py\[2mregistry.py[0m]8;;\[2m:[0m]8;id=244098;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py#85\[2m85[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.base_reward:Initialized SemanticSimilarityReward with config: [1m{[0m[32m'method'[0m: [32m'jaccard'[0m[1m}[0m                                                      ]8;id=475435;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=666563;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#37\[2m37[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.registry:Created reward instance: [32m'semantic_similarity'[0m.                                                                                    ]8;id=372528;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py\[2mregistry.py[0m]8;;\[2m:[0m]8;id=219684;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py#85\[2m85[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.rewards.base_reward:Initialized RewardComposer with [1;36m2[0m rewards.                                                                                   ]8;id=679514;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=74870;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#144\[2m144[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.data.dataset_manager:DatasetManager initialized.                                                                                             ]8;id=171339;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py\[2mdataset_manager.py[0m]8;;\[2m:[0m]8;id=484714;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py#73\[2m73[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.core.trainer:BaseTrainer initialized.                                                                                                                 ]8;id=230283;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py\[2mtrainer.py[0m]8;;\[2m:[0m]8;id=717870;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py#69\[2m69[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:root:Loading [32m'actor'[0m model from [35m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[95mlatest[0m using mlx-lm[33m...[0m                          ]8;id=861722;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=33659;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#84\[2m84[0m]8;;\
âœ“ Loaded [32m'actor'[0m model from [32m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[32mlatest[0m
[2;36m[10/07/25 21:57:43][0m[2;36m [0m[34mINFO    [0m INFO:root:Set [32m'actor'[0m model to training mode                                                                                                                        ]8;id=221231;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=957492;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#96\[2m96[0m]8;;\
Trainable parameters: 100.000% (4022.468M/4022.468M)
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:root:Loading [32m'reference'[0m model from [35m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[95mlatest[0m using mlx-lm[33m...[0m                      ]8;id=329963;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=222955;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#84\[2m84[0m]8;;\
âœ“ Loaded [32m'reference'[0m model from [32m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[32mlatest[0m
[2;36m[10/07/25 21:57:44][0m[2;36m [0m[34mINFO    [0m INFO:root:Set [32m'reference'[0m model to evaluation mode                                                                                                                 ]8;id=674079;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=481141;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#100\[2m100[0m]8;;\
[33mNo checkpoint found. Starting from scratch.[0m
Normalizing train data: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 845029/845029 [01:14<00:00, 11346.06it/s]
Normalizing val data: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 79816/79816 [00:07<00:00, 10476.75it/s]
[2;36m[10/07/25 22:00:17][0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.data.dataset_manager:Datasets loaded. Train: [1;36m828286[0m, Val: [1;36m78728[0m                                                                              ]8;id=588637;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py\[2mdataset_manager.py[0m]8;;\[2m:[0m]8;id=565158;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py#111\[2m111[0m]8;;\
Training Progress:   0%|                                                                                                                                                               | 0/1000 [00:00<?, ?update/s][2;36m[10/07/25 22:00:19][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m367786[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=76241;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=267072;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m526837[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=333623;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=74997;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m134356[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=157883;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=254250;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m631074[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=168482;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=810409;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m669167[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=902988;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=603119;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m372229[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=369262;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=566270;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m41792[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=117955;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=283071;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m61921[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=418793;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=498411;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m164308[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=802483;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=418014;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m673953[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=316205;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=188620;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m712779[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=374664;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=58449;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m294467[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=407790;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=664673;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m665508[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=725601;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=372675;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m291144[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=665878;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=127312;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m204408[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=154751;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=227225;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m396797[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=241165;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=11884;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m45239[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=564546;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=107272;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m224574[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=776944;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=42996;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m213277[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=318816;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=167257;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m735464[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=476569;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=857748;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m7650[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=877012;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=777631;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m253853[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=822939;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=714503;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m700980[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=229764;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=511900;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m691832[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=104119;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=662502;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:20][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m812278[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=780110;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=172293;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m453416[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=912618;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=493100;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m417057[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=828358;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=671042;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m361285[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=707353;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=449470;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m303535[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=993397;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=911407;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m297448[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=593993;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=744132;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m12881[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=524494;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=514139;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m566928[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=106756;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=951311;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m79585[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=633292;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=87262;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m197916[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=844712;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=491766;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m321935[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=694486;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=497405;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m767011[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=856676;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=579732;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m394902[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=84415;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=934213;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m722991[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=181334;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=699490;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m251089[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=25662;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=72526;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m201744[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=301636;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=991623;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m313890[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=148967;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=419970;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m200708[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=624602;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=291883;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m67451[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=955586;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=580571;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m152050[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=366780;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=167979;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m390548[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=424943;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=825112;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m180028[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=901803;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=705525;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m414965[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=669140;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=82213;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m371549[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=147630;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=274368;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m791627[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=900552;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=842497;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m812908[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=551541;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=614421;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m17415[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=419975;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=691264;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:21][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m412104[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=212510;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=933923;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m164295[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=101627;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=103174;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m100460[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=395711;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=605563;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m699852[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=782858;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=519876;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m311869[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=312034;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=529268;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m407859[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=532996;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=103285;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m565365[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=633674;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=148384;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m629911[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=301029;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=510938;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m677269[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=256968;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=903497;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m144855[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=210858;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=264458;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m534413[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=993221;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=55199;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m737511[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=199546;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=127785;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m573777[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=571776;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=274007;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m75359[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=702094;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=361925;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m189973[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=382350;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=45713;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m641271[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=741809;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=61707;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m414951[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=886011;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=867683;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m167594[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=380729;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=739;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m770823[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=383891;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=335841;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m25584[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=189500;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=263474;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m622137[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=966454;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=846722;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m4765[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=614684;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=808219;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m466235[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=941531;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=585591;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m109033[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=336124;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=242039;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m534386[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=298774;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=647392;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m195371[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=534999;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=545644;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m475530[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=147168;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=163021;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:22][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m817884[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=27154;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=298132;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m78719[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=484850;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=242794;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m393052[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=646015;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=994826;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m161303[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=866745;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=633218;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m299274[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=613188;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=799999;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m412267[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=140247;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=73139;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m11341[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=868232;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=523217;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m135947[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=144246;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=713411;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m574375[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=710819;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=226189;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m815970[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=650676;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=722330;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m497478[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=528698;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=485296;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m211028[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=836695;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=77742;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m193773[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=743644;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=818368;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m616860[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=73987;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=596724;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m89011[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=322610;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=519197;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m549629[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=827613;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=541877;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m211902[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=460187;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=569820;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m758942[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=354339;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=678851;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m694965[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=922218;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=403737;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m547120[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=173795;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=380890;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m595314[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=714746;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=630637;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m261872[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=989917;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=370919;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m361761[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=657761;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=143611;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m438182[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=793004;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=777784;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m686914[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=293297;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=959136;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m254808[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=888034;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=821786;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m726950[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=104180;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=102996;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m209296[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=637805;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=487207;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:23][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m388700[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=279582;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=495352;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m627022[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=960643;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=35079;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m170640[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=886014;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=47820;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m300717[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=454047;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=871359;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m723223[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=554655;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=136205;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m758555[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=744287;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=924719;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m163474[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=615410;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=256332;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m374916[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=300284;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=60717;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m410343[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=825054;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=752001;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m286028[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=518469;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=220792;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m439636[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=875644;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=645071;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m571768[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=433193;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=33117;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m560323[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=463999;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=195329;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m623479[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=848653;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=566648;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m561848[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=686239;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=148954;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m418448[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=329306;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=543797;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m234585[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=799440;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=190302;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m24485[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=930537;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=63790;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m232645[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=288566;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=891295;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m691159[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=357329;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=941892;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m168934[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=416582;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=960657;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m510411[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=324604;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=387702;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m508637[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=130831;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=460365;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m293383[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=508784;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=42387;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m366236[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=42070;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=26012;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m125990[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=817051;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=652692;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m41030[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=20483;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=864660;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:24][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m624690[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=751398;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=473541;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m242177[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=38742;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=615160;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m480158[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=450808;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=343528;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m584230[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=957049;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=846625;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m367841[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=4003;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=42022;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m603777[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=483500;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=917917;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m343906[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=834315;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=966722;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m509795[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=881386;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=875080;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m11093[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=809805;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=213214;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m696716[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=468996;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=70097;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m591508[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=983276;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=450972;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m125231[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=697337;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=713842;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m82577[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=727170;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=187862;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m156547[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=356391;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=804957;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m685309[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=763467;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=98795;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m774125[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=540240;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=24265;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m431108[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=44904;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=877541;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m27789[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=141515;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=985269;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m322384[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=717525;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=329118;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m6329[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=819970;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=431407;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m310057[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=873097;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=94872;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m212438[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=119437;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=14123;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m154156[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=298706;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=811194;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m36932[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=10532;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=464581;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m392436[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=992118;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=305783;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m183655[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=340935;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=836078;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m21853[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=747485;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=45209;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m812196[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=968457;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=879104;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:25][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m416871[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=112345;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=355240;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m140127[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=783310;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=916638;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m212327[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=35981;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=91418;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m458519[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=402608;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=995475;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m561603[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=531259;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=85305;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m481692[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=800613;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=770173;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m587015[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=108784;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=100935;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m790863[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=18272;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=153544;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m333797[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=207557;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=292705;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m134899[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=677280;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=945993;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m813969[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=988799;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=482314;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m513574[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=925427;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=296457;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m28897[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=71244;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=904174;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m18804[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=785904;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=873145;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m716745[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=865499;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=897985;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m96503[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=795574;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=173559;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m614501[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=392370;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=621803;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m193133[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=166250;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=928381;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m1594[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=178858;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=24972;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m321785[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=719083;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=586540;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m9034[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=116403;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=713773;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m827126[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=874864;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=336963;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m681871[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=828106;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=812613;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m131661[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=3497;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=136748;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m810149[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=928103;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=268863;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m218052[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=787037;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=618831;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m408400[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=720529;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=287430;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m362856[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=3725;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=930663;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:26][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m630859[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=205021;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=823456;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m284325[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=302432;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=998621;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m813378[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=724132;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=23315;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m769173[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=140904;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=168082;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m519506[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=359594;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=903889;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m712417[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=585015;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=322655;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m549781[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=881372;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=440487;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m754414[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=120590;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=525177;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m302436[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=880476;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=342189;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m818190[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=761301;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=520234;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m689446[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=823271;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=430209;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m714841[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=78566;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=423096;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m495947[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=47699;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=253286;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m371281[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=990198;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=519964;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m362125[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=18800;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=796684;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m54853[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=241292;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=267607;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m55055[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=617083;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=256949;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m814789[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=695651;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=278845;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m437882[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=226456;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=11904;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m616454[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=858737;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=647369;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m612607[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=539117;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=43657;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m324097[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=76121;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=209612;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m595221[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=742977;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=826707;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m520849[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=959209;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=753672;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m71678[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=793913;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=723313;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m409575[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=868356;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=313178;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m247353[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=231936;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=314828;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:27][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m743577[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=659251;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=765066;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m105903[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=579417;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=380606;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m517751[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=247710;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=775633;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m327930[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=621861;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=471287;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m568032[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=282310;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=117025;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m442019[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=393977;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=786296;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m673790[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=286231;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=187120;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m607905[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=466214;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=265952;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m163232[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=83422;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=385083;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m137237[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=511285;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=768670;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m489985[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=132331;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=263;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m292176[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=526853;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=62706;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m296611[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=112579;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=192650;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m439717[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=292326;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=374215;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m572472[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=290250;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=483971;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m75269[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=637655;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=840830;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m343875[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=448142;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=502006;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m675652[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=384945;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=319036;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m565962[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=145995;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=48827;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m223556[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=495468;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=80595;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m658754[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=558761;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=408730;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m760927[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=31161;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=560519;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m693469[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=656782;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=167396;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m816586[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=323266;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=291086;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:28][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m129209[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=798864;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=829708;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m731037[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=323162;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=760631;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m707802[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=678187;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=782927;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m353000[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=453428;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=618115;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m227320[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=420477;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=928289;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m104362[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=535885;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=230977;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m794942[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=730355;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=734295;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m91252[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=614384;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=583732;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m44956[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=773866;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=458039;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m494070[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=63869;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=136698;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m137373[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=703315;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=379188;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m660913[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=123733;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=917990;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m71431[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=832067;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=522714;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m608152[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=559361;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=319123;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m471222[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=59453;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=551006;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m642352[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=820499;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=839819;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m816956[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=77990;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=577369;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m488826[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=629746;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=193839;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m825190[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=31917;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=884888;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m501528[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=686618;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=370859;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m429923[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=122000;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=718404;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m57543[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=778616;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=575712;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m272119[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=353265;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=631974;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m174565[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=420471;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=103217;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m262421[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=135301;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=951000;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m18741[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=994647;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=172697;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m582879[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=474571;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=657220;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m769321[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=301423;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=867576;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m

[1;33mShutdown requested. Finishing current step and saving checkpoint[0m[1;33m...[0m
[2;36m[10/07/25 22:00:29][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m551212[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=735910;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=708941;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m331781[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=589437;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=324907;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m72776[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=368834;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=332555;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m468808[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=461246;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=624414;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m573416[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=270414;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=592518;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m738961[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=837231;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=919796;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m170279[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=833664;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=98487;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m224215[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=627893;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=111739;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m379040[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=808474;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=76877;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m142987[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=999112;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=65778;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m577640[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=769985;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=933982;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m785469[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=223399;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=907766;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m311404[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=903037;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=722960;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m656482[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=337627;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=542954;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m2323[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=822261;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=806554;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m35906[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=827756;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=298532;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m45946[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=142499;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=631834;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m792953[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=505899;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=79780;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m187719[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=467386;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=928383;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m560550[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=328924;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=706202;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m298568[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=614911;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=573871;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m307471[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=656691;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=206875;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m307040[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=820256;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=552883;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m282201[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=589811;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=102285;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:30][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m317318[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=135687;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=926455;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m31296[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=977656;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=416265;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m51217[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=399737;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=266459;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m137986[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=260991;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=656568;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m224899[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=994818;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=430803;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m680957[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=439040;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=411416;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m481396[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=514536;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=515637;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m48464[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=928329;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=440523;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m317853[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=583277;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=828485;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m6614[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=574845;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=799132;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m744714[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=307630;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=318161;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m606033[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=286066;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=408375;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m736066[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=948519;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=85855;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m243548[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=516903;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=716379;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m16813[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=419680;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=424860;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m46082[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=189315;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=315081;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m642655[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=882537;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=232092;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m791622[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=377936;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=672326;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m691973[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=424840;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=685909;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m329049[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=620153;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=364205;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m717432[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=435694;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=364122;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m269592[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=660267;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=245643;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m306032[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=485599;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=652923;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m749782[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=519834;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=641515;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:31][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m625520[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=121121;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=914602;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m550776[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=452911;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=13354;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m727400[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=825648;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=707652;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m109514[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=173731;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=383911;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m513590[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=614675;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=848001;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m584733[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=285643;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=244044;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m320197[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=356456;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=208341;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m621579[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=319601;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=809405;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m546584[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=650168;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=902613;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m478587[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=293216;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=345556;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m257871[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=169241;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=985741;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m699602[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=537600;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=581098;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m559040[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=448227;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=569810;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m123235[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=623790;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=337216;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m726542[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=790422;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=544887;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m545523[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=244264;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=989965;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m461727[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=238371;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=48161;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m812856[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=26362;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=415798;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m649315[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=847666;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=176416;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m42502[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=355194;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=451428;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m396404[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=466809;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=136566;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m279632[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=62857;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=900481;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m443821[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=951662;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=907823;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m126289[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=427385;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=752576;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m534886[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=580181;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=59251;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m745669[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=54778;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=585223;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m161301[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=894447;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=230255;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:32][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m362378[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=913185;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=435612;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m2105[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=282035;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=2947;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m399324[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=946615;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=676058;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m64742[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=219007;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=888157;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m810985[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=607686;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=478983;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m679404[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=609458;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=51453;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m510055[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=930721;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=88798;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m528110[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=687929;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=425026;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m596859[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=606110;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=868731;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m132375[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=790089;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=188069;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m87716[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=638103;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=5467;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m779192[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=421659;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=627833;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m578163[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=473992;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=955222;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m775105[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=241332;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=432852;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m77839[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=393859;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=552344;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m781809[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=867862;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=957107;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m118353[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=801911;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=173136;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m796408[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=201555;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=395863;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m350639[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=896433;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=77530;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m483793[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=820430;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=202306;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m310252[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=736057;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=763795;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m520939[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=948557;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=904147;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m488493[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=802333;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=712309;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m586146[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=540183;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=845147;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:33][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m368523[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=343878;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=678582;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m639812[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=317197;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=816113;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m112459[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=664714;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=387514;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m206261[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=617115;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=939933;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m591847[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=638758;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=437360;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m42177[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=799027;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=207061;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m420778[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=423262;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=190256;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m811712[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=488744;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=230688;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m396546[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=530470;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=352811;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m353502[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=339736;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=421240;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m157089[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=387676;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=806649;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m5262[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m         ]8;id=420293;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=816499;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m769342[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=939812;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=340716;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m134251[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=5456;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=448214;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m389764[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=28407;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=927741;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m433119[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=326366;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=615747;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m542409[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=297526;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=724265;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m363276[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=956417;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=753926;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m309063[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=509971;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=531475;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m784066[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=519112;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=764411;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m454201[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=305497;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=569817;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m83930[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m        ]8;id=320576;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=142190;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m385220[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=504825;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=785737;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m521856[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=822324;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=298510;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m654223[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=752300;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=361501;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m400883[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=382512;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=656467;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m305175[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=320807;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=969562;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m630603[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=39715;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=675614;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m[10/07/25 22:00:34][0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m441532[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=970027;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=550133;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m289350[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=2048;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=609304;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m288191[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=955445;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=531758;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m610497[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=192527;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=240283;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m316777[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=620996;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=275194;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m635899[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=695241;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=73147;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m551641[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=923792;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=356134;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m514956[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=925449;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=620657;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m310957[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=819393;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=689505;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m813229[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=788906;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=945585;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m513978[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=178392;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=185144;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m376574[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=293899;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=556019;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m477945[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=734278;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=127921;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m579111[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=401027;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=592628;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m181253[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=632510;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=933078;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m580393[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=422343;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=369499;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m228959[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=961523;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=942477;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m WARNING:mlx_rl_trainer.data.batch_builder:Skipping sample idx [1;36m248125[0m due to error during batch building: [32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m       ]8;id=3387;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py\[2mbatch_builder.py[0m]8;;\[2m:[0m]8;id=228420;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/batch_builder.py#68\[2m68[0m]8;;\
[2;36m                    [0m         [31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mbatch_builder.py[0m:44 in build_rollout_batch                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m41 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m42 [0m[2mâ”‚   â”‚   â”‚   [0mmcq_meta = _mcq_meta_from_sample({[33m'[0m[33mprompt[0m[33m'[0m: prompt_text, [33m'[0m[33mcompletion[0m[33m'[0m:                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      ref_ans, [33m'[0m[33mmeta[0m[33m'[0m: raw.get([33m'[0m[33mmeta[0m[33m'[0m, {})})                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m43 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m44 [2mâ”‚   â”‚   â”‚   [0mformatted_prompt = apply_chat_template_wrapper(tokenizer, prompt_text,                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m      config.system_prompt)                                                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m45 [0m[2mâ”‚   â”‚   â”‚   [0mp_tokens = tokenizer.encode(formatted_prompt, add_special_tokens=[94mTrue[0m)                                                                         [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m46 [0m[2mâ”‚   â”‚   â”‚   [0m                                                                                                                                               [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m47 [0m[2mâ”‚   â”‚   â”‚   [0m[2m# CORRECTED: Access max_prompt_len via config.data[0m                                                                                             [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [2m/opt/homebrew/Caskroom/miniforge/base/envs/p311/lib/python3.11/site-packages/pydantic/[0m[1mmain.py[0m:991 in __getattr__                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m                                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 988 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[94mreturn[0m [96msuper[0m().[92m__getattribute__[0m(item)  [2m# Raises AttributeError [0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [2mif appropriate[0m                                                                                                                                           [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 989 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   [0m[94melse[0m:                                                                                                                                [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 990 [0m[2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[2m# this is the current error[0m                                                                                                      [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m [31mâ± [0m 991 [2mâ”‚   â”‚   â”‚   â”‚   â”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mAttributeError[0m[1;4m([0m[1;4;33mf[0m[1;4;33m'[0m[1;4;33m{[0m[1;4;96mtype[0m[1;4m([0m[1;4;96mself[0m[1;4m).[0m[1;4;91m__name__[0m[1;4;33m!r}[0m[1;4;33m object has no [0m                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [1;4;33mattribute [0m[1;4;33m{[0m[1;4mitem[0m[1;4;33m!r}[0m[1;4;33m'[0m[1;4m)[0m                                                                                                                                     [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 992 [0m[2mâ”‚   â”‚   [0m                                                                                                                                                 [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 993 [0m[2mâ”‚   â”‚   [0m[94mdef[0m[90m [0m[92m__setattr__[0m([96mself[0m, name: [96mstr[0m, value: Any) -> [94mNone[0m:                                                                                            [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m   [2m 994 [0m[2mâ”‚   â”‚   â”‚   [0m[94mif[0m (setattr_handler := [96mself[0m.__pydantic_setattr_handlers__.get(name)) [95mis[0m [95mnot[0m                                                                  [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ”‚[0m        [94mNone[0m:                                                                                                                                                    [31mâ”‚[0m [2m                   [0m
[2;36m                    [0m         [31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m [2m                   [0m
[2;36m                    [0m         [1;91mAttributeError: [0m[32m'DataConfig'[0m object has no attribute [32m'system_prompt'[0m                                                                                                [2m                   [0m

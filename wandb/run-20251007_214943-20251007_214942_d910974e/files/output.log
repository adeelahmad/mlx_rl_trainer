[2;36m[10/07/25 21:49:45][0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.scripts.train:W&B logging initialized: [4;94mhttps://wandb.ai/adeelahmad99/mlx-grpo/runs/20251007_214942_d910974e[0m                                            ]8;id=481741;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py\[2mtrain.py[0m]8;;\[2m:[0m]8;id=562275;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py#135\[2m135[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.base_reward:Initialized CodeExecutionReward with config: [1m{[0m[32m'timeout'[0m: [1;36m3[0m[1m}[0m                                                                  ]8;id=869693;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=659176;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#37\[2m37[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.rewards.programming.code_execution:Initialized CodeExecutionReward with timeout: 3s.                                                          ]8;id=738797;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/programming/code_execution.py\[2mcode_execution.py[0m]8;;\[2m:[0m]8;id=72933;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/programming/code_execution.py#125\[2m125[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.registry:Created reward instance: [32m'code_execution'[0m.                                                                                         ]8;id=896865;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py\[2mregistry.py[0m]8;;\[2m:[0m]8;id=244098;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py#85\[2m85[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.base_reward:Initialized SemanticSimilarityReward with config: [1m{[0m[32m'method'[0m: [32m'jaccard'[0m[1m}[0m                                                      ]8;id=475435;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=666563;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#37\[2m37[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.rewards.registry:Created reward instance: [32m'semantic_similarity'[0m.                                                                                    ]8;id=372528;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py\[2mregistry.py[0m]8;;\[2m:[0m]8;id=219684;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/registry.py#85\[2m85[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.rewards.base_reward:Initialized RewardComposer with [1;36m2[0m rewards.                                                                                   ]8;id=679514;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py\[2mbase_reward.py[0m]8;;\[2m:[0m]8;id=74870;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/rewards/base_reward.py#144\[2m144[0m]8;;\
[2;36m                   [0m[2;36m [0m[32mDEBUG   [0m DEBUG:mlx_rl_trainer.data.dataset_manager:DatasetManager initialized.                                                                                             ]8;id=171339;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py\[2mdataset_manager.py[0m]8;;\[2m:[0m]8;id=484714;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/dataset_manager.py#73\[2m73[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.core.trainer:BaseTrainer initialized.                                                                                                                 ]8;id=230283;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py\[2mtrainer.py[0m]8;;\[2m:[0m]8;id=717870;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/trainer.py#69\[2m69[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:root:Loading [32m'actor'[0m model from [35m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[95mlatest[0m using mlx-lm[33m...[0m                          ]8;id=861722;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=33659;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#84\[2m84[0m]8;;\
✓ Loaded [32m'actor'[0m model from [32m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[32mlatest[0m
[2;36m[10/07/25 21:49:47][0m[2;36m [0m[34mINFO    [0m INFO:root:Set [32m'actor'[0m model to training mode                                                                                                                        ]8;id=221231;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=957492;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#96\[2m96[0m]8;;\
Trainable parameters: 100.000% (4022.468M/4022.468M)
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:root:Loading [32m'reference'[0m model from [35m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[95mlatest[0m using mlx-lm[33m...[0m                      ]8;id=329963;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=222955;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#84\[2m84[0m]8;;\
✓ Loaded [32m'reference'[0m model from [32m/Users/adeelahmad/work/SiLLM-examples/helpsteer/mlx-grpo/outy1266_align_last30/[0m[32mlatest[0m
[2;36m[10/07/25 21:49:48][0m[2;36m [0m[34mINFO    [0m INFO:root:Set [32m'reference'[0m model to evaluation mode                                                                                                                 ]8;id=674079;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py\[2mmodel_manager.py[0m]8;;\[2m:[0m]8;id=481141;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/model_manager.py#100\[2m100[0m]8;;\
[33mNo checkpoint found. Starting from scratch.[0m
[2;36m                   [0m[2;36m [0m[1;7;31mCRITICAL[0m CRITICAL:mlx_rl_trainer.scripts.train:An unexpected error occurred during training: name [32m'aiofiles'[0m is not defined                                                         ]8;id=588637;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py\[2mtrain.py[0m]8;;\[2m:[0m]8;id=565158;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py#187\[2m187[0m]8;;\
[2;36m                    [0m         [31m╭─[0m[31m─────────────────────────────────────────────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m──────────────────────────────────────────────────────────────────[0m[31m─╮[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/[0m[1mtrain.py[0m:179 in _async_main                                                     [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m176 [0m[2m│   │   [0m[94mraise[0m [96mValueError[0m([33mf[0m[33m"[0m[33mUnknown algorithm: [0m[33m{[0mconfig.trainer.algorithm[33m}[0m[33m"[0m)                                                                                       [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m177 [0m[2m│   [0m                                                                                                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m178 [0m[2m│   [0m[94mtry[0m:                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m179 [2m│   │   [0m[94mawait[0m trainer.run([94mlambda[0m: shutdown_requested)                                                                                                            [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m180 [0m[2m│   │   [0mlogger.info([33m"[0m[33m[bold green]Training completed successfully![/bold green][0m[33m"[0m)                                                                                 [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m181 [0m[2m│   [0m[94mexcept[0m CustomBaseException [94mas[0m e:                                                                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m182 [0m[2m│   │   [0mlogger.critical([33mf[0m[33m"[0m[33mA predictable error halted training: [0m[33m{[0me[33m}[0m[33m"[0m, exc_info=[94mTrue[0m)                                                                              [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/core/[0m[1mtrainer.py[0m:95 in run                                                               [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 92 [0m[2m│   │   │   [0m[96mself[0m.data_manager.set_tokenizer([96mself[0m.tokenizer)                                                                                                      [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 93 [0m[2m│   │   │   [0m[96mself[0m.data_manager.set_system_prompt([96mself[0m.config.system_prompt)                                                                                       [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 95 [2m│   │   [0m[1;4;94mawait[0m[1;4m [0m[1;4;96mself[0m[1;4m.data_manager.load_datasets()[0m                                                                                                                  [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   [0m                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 97 [0m[2m│   │   [0mpbar = trange([96mself[0m.global_step, [96mself[0m.config.trainer.num_training_steps,                                                                                  [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       initial=[96mself[0m.global_step, desc=[33m"[0m[33mTraining Progress[0m[33m"[0m, unit=[33m"[0m[33mupdate[0m[33m"[0m, leave=[94mTrue[0m)                                                                                   [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   [0mtrain_data_iterator = [96miter[0m([96mself[0m.data_manager.get_dataloader([33m"[0m[33mtrain[0m[33m"[0m,                                                                                     [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       [96mself[0m.config.trainer.ppo_batch_size))                                                                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mdataset_manager.py[0m:105 in load_datasets                                            [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m102 [0m[2m│   │   │   │   [0mdataset_obj = [94mawait[0m asyncio.to_thread(load_dataset, path.as_posix(),                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       split=hf_split_name)                                                                                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m103 [0m[2m│   │   │   │   [0m[94mreturn[0m dataset_obj.to_list() [94mif[0m [96mhasattr[0m(dataset_obj, [33m'[0m[33mto_list[0m[33m'[0m) [94melse[0m                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       [96mlist[0m(dataset_obj)                                                                                                                                                [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m104 [0m[2m│   │   [0m                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m105 [2m│   │   [0mraw_train_data = [1;4;94mawait[0m[1;4m load_raw_data_for_split([0m[1;4;96mself[0m[1;4m.config.train_path, [0m[1;4;33m"[0m[1;4;33mtrain[0m[1;4;33m"[0m[1;4m)[0m                                                                          [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m106 [0m[2m│   │   [0mraw_val_data = [94mawait[0m load_raw_data_for_split([96mself[0m.config.val_path, [33m"[0m[33mval[0m[33m"[0m) [94mif[0m                                                                             [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       [96mself[0m.config.val_path [94melse[0m []                                                                                                                                     [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m107 [0m[2m│   │   [0m                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m108 [0m[2m│   │   [0m[96mself[0m._train_dataset = [96mself[0m._process_raw_to_dataset(raw_train_data, [33m"[0m[33mtrain[0m[33m"[0m)                                                                              [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mdataset_manager.py[0m:96 in load_raw_data_for_split                                   [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 93 [0m[2m│   │   [0m                                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94masync[0m [94mdef[0m[90m [0m[92mload_raw_data_for_split[0m(path: Path, split_name: [96mstr[0m) -> List[Dict[[96mstr[0m,                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       Any]]:                                                                                                                                                           [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m path: [94mreturn[0m []                                                                                                                               [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 96 [2m│   │   │   [0m[94mif[0m path.suffix.lower() [95min[0m [[33m'[0m[33m.jsonl[0m[33m'[0m, [33m'[0m[33m.ndjson[0m[33m'[0m]: [94mreturn[0m [1;4;94mawait[0m[1;4m [0m                                                                                       [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       [1;4;96mself[0m[1;4m._async_read_jsonl(path)[0m                                                                                                                                     [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 97 [0m[2m│   │   │   [0m[94melif[0m path.suffix.lower() == [33m'[0m[33m.json[0m[33m'[0m:                                                                                                                 [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0mraw_content = [94mawait[0m aiofiles.open(path, mode=[33m'[0m[33mr[0m[33m'[0m,                                                                                                [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m       encoding=[33m'[0m[33mutf-8[0m[33m'[0m).read()                                                                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   [0m[94mreturn[0m json.loads(raw_content)                                                                                                                   [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [2m/Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/data/[0m[1mdataset_manager.py[0m:83 in _async_read_jsonl                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m                                                                                                                                                                        [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 80 [0m[2m│   [0m[94masync[0m [94mdef[0m[90m [0m[92m_async_read_jsonl[0m([96mself[0m, path: Path) -> List[Dict[[96mstr[0m, Any]]:                                                                                       [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 81 [0m[2m│   │   [0m[94mif[0m [95mnot[0m path.is_file(): [94mraise[0m [96mFileNotFoundError[0m([33mf[0m[33m"[0m[33mData file not found: [0m[33m{[0mpath[33m}[0m[33m"[0m)                                                                           [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 82 [0m[2m│   │   [0mdata = []                                                                                                                                                [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 83 [2m│   │   [0m[94masync[0m [94mwith[0m [1;4maiofiles[0m.open(path, mode=[33m"[0m[33mr[0m[33m"[0m, encoding=[33m"[0m[33mutf-8[0m[33m"[0m) [94mas[0m f:                                                                                         [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 84 [0m[2m│   │   │   [0m[94masync[0m [94mfor[0m line [95min[0m f:                                                                                                                                 [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 85 [0m[2m│   │   │   │   [0m[94mif[0m line.strip():                                                                                                                                 [31m│[0m [2m            [0m
[2;36m                    [0m         [31m│[0m   [2m 86 [0m[2m│   │   │   │   │   [0m[94mtry[0m: data.append(json.loads(line.strip()))                                                                                                   [31m│[0m [2m            [0m
[2;36m                    [0m         [31m╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯[0m [2m            [0m
[2;36m                    [0m         [1;91mNameError: [0mname [32m'aiofiles'[0m is not defined                                                                                                                                  [2m            [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m INFO:mlx_rl_trainer.scripts.train:Application shutdown sequence initiated.                                                                                                 ]8;id=611878;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py\[2mtrain.py[0m]8;;\[2m:[0m]8;id=418801;file:///Users/adeelahmad/work/themlx/mlx_rl_trainer/mlx_rl_trainer/src/mlx_rl_trainer/scripts/train.py#194\[2m194[0m]8;;\
